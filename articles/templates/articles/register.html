{% extends 'articles/base.html' %}

{% load static %}

{% block styles %}
  <link rel="stylesheet" type="text/css" href="{% static 'articles/style.css' %}">
{% endblock %}

{% block register_active %}class="active"{% endblock %}

{% block content %}

  <div class="container after-nav">
    <br><br><br>
    <div class="row">
      <div class="col-lg-4 col-lg-offset-4 col-sm-6 col-sm-offset-3">
        <div class="well">
          <h1 class="text-center">Register</h1>

          <div class="row">
            <div class="col-sm-2"></div>
            <div class="col-sm-8">
              <h4 class="text-center">Insert your data to get started with your registration</h4>
            </div>
            <div class="col-sm-2"></div>
          </div>

          <br>
          <span class="glyphicon glyphicon-user auth-img"></span>
          <br>

          <form class="form-signin" method="POST" action="{% url 'articles:register' %}">
            {% csrf_token %}

            <input type="text" name="username" class="form-control auth-form-control text-center" placeholder="username" required autofocus>
            {% if user_already_exists %}
            <p class="text-danger">Username <b>{{ username }}</b> already exists!</p>
            {% endif %}

            <input type="email" name="email_address"  id="email" class="form-control auth-form-control text-center" placeholder="email" required>
            {% if email_already_exists %}
            <p class="text-danger">The email address <b>{{ email }}</b> is already being used!</p>
            {% endif %}

            <input type="password" name="password1"  id="password1" class="form-control auth-form-control text-center" placeholder="password" required>
            <input type="password" name="password2"  id="password2" class="form-control auth-form-control text-center" placeholder="confirm password" required>
            <p id="different_passwords_error" class="text-danger">Make sure both passwords are the same.</p>

            <button class="btn btn-lg btn-success btn-block" type="submit">Register</buttson>

            <span class="clearfix"></span>
          </form>
        </div>
      </div>
    </div>
  </div>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>
    var a = true;
    var times = 6;

    function blink(){
      element = document.getElementById("different_passwords_error");
      if (times>0){
        if (a==true){
          element.style.color='#f5f5f5';
          a = false;
          setTimeout(blink, 100);
        }
        else{
          element.style.color='#a94442';
          a = true;
          setTimeout(blink, 400);
        }
        times--;
      }
      else{
        //document.getElementById('different_passwords_error').style.display='none';
        times = 6;
      }
    }

    // -------------------------------------------------------------
    // Alterar as chamadas ao DOM pela sintaxe do jQuery...
    // ... ou, alternativamente, não utilizar jQuery.
    // -------------------------------------------------------------
    $(document).ready(function(){
  	   var $form = $('form');
  	   $form.submit(function(){

          // -------------------------------------------------------------
          // Adicionalmente, substituir as referências aos identificadores
          // dos elementos HTML por referências a campos extraídos da
          // variável "form" (de acordo com o atributo "name")
          // -------------------------------------------------------------
          if (document.getElementById('password1').value!=document.getElementById('password2').value){
            document.getElementById('different_passwords_error').style.display='block';
            blink();
            document.getElementById('password2').value='';
            document.getElementById('password2').focus();
            return false;
          }
  	   });
  	});
  </script>

{% endblock %}
